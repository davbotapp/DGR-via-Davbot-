"use client";import { useState, useRef, useEffect } from "react";export default function Home() {  const [messages, setMessages] = useState([]);  const [input, setInput] = useState("");  const [loading, setLoading] = useState(false);  const scrollRef = useRef(null);  useEffect(() => { scrollRef.current?.scrollIntoView({ behavior: "smooth" }); }, [messages]);  const handleSend = async () => {    if (!input.trim() || loading) return;    const userText = input;    setMessages(prev => [...prev, { role: "user", text: userText }]);    setInput("");    setLoading(true);    try {      const res = await fetch("/api/chat", {        method: "POST",        headers: { "Content-Type": "application/json" },        body: JSON.stringify({ prompt: userText, history: messages }),      });      const data = await res.json();      setMessages(prev => [...prev, { role: "model", text: data.text }]);    } catch (e) {      setMessages(prev => [...prev, { role: "model", text: "❌ Erreur de connexion." }]);    } finally {      setLoading(false);    }  };  return (    <div className="main">      <div className="card">        <header className="head">          <div className="status">● ONLINE</div>          <div className="title">TERMUX IA <span className="pro">PRO</span></div>        </header>        <div className="chat">          {messages.length === 0 && <div className="welcome">Posez votre question...</div>}          {messages.map((m, i) => (            <div key={i} className={`bubble ${m.role}`}>{m.text}</div>          ))}          {loading && <div className="bubble model loading">...</div>}          <div ref={scrollRef} />        </div>        <div className="input-bar">          <input value={input} onChange={e => setInput(e.target.value)} onKeyDown={e => e.key === "Enter" && handleSend()} placeholder="Écrire..." />          <button onClick={handleSend}>➤</button>        </div>      </div>      <style jsx>{`        .main { height: 100dvh; background: #0a0a0b; display: flex; align-items: center; justify-content: center; padding: 10px; }        .card { width: 100%; max-width: 500px; height: 95vh; background: rgba(255,255,255,0.03); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.1); border-radius: 30px; display: flex; flex-direction: column; }        .head { padding: 30px 20px 15px; display: flex; justify-content: space-between; border-bottom: 1px solid rgba(255,255,255,0.05); }        .status { color: #10b981; font-size: 10px; font-weight: bold; }        .title { color: white; font-weight: bold; font-size: 16px; }        .pro { background: #4f46e5; font-size: 10px; padding: 2px 6px; border-radius: 4px; }        .chat { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }        .bubble { max-width: 85%; padding: 14px; border-radius: 18px; color: white; font-size: 15px; line-height: 1.5; }        .user { align-self: flex-end; background: #4f46e5; border-bottom-right-radius: 4px; }        .model { align-self: flex-start; background: rgba(255,255,255,0.1); border-bottom-left-radius: 4px; }        .input-bar { padding: 20px; display: flex; gap: 10px; }        input { flex: 1; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 15px; padding: 12px; color: white; outline: none; }        button { background: #4f46e5; border: none; border-radius: 15px; width: 50px; color: white; cursor: pointer; }        .welcome { color: rgba(255,255,255,0.2); text-align: center; margin-top: 50%; }        .loading { font-style: italic; opacity: 0.5; }      `}</style>    </div>  );}
